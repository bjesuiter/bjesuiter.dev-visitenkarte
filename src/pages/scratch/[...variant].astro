---
import Layout from "../../layouts/Layout.astro";
import Variant1 from "../../components/scratch/Variant1.astro";
import Variant3 from "../../components/scratch/Variant3.astro";
import Variant5 from "../../components/scratch/Variant5.astro";

const runtimeVariants = ["1", "3", "5"] as const;
type RuntimeVariant = (typeof runtimeVariants)[number];

export function getStaticPaths() {
  const staticVariants = ["1", "3", "5"];

  if (import.meta.env.PROD) {
    return [];
  }

  return [
    { params: { variant: undefined } },
    ...staticVariants.map((variant) => ({ params: { variant } })),
  ];
}

const rawVariant = Astro.params.variant;
if (rawVariant === undefined) {
  return Astro.redirect("/scratch/1");
}

const variant = runtimeVariants.includes(rawVariant as RuntimeVariant)
  ? (rawVariant as RuntimeVariant)
  : undefined;
const showUnknown = rawVariant !== undefined && variant === undefined;
---

<Layout
  title={variant
    ? `bjesuiter.dev · Scratch ${variant}`
    : "bjesuiter.dev · Scratch"}
>
  <main class:list={["scratch-shell", variant && `scratch-shell-${variant}`]}>
    <nav class="scratch-nav" aria-label="Scratch variants">
      <a href="/">Base</a>
      <a href="/scratch/1" aria-current={variant === "1" ? "page" : undefined}
        >1</a
      >
      <a href="/scratch/3" aria-current={variant === "3" ? "page" : undefined}
        >3</a
      >
      <a href="/scratch/5" aria-current={variant === "5" ? "page" : undefined}
        >5</a
      >
    </nav>

    {variant === "1" && <Variant1 />}
    {variant === "3" && <Variant3 />}
    {variant === "5" && <Variant5 />}

    {
      showUnknown && (
        <section class="scratch-home">
          <h1>Unknown Variant</h1>
          <p>
            This scratch variant is not active. Use{" "}
            <a href="/scratch">/scratch</a> to pick 1, 3, or 5.
          </p>
        </section>
      )
    }
  </main>
</Layout>

<style is:global>
  .scratch-shell {
    min-height: 100vh;
    padding: clamp(1rem, 2vw, 2rem);
    background:
      radial-gradient(circle at 5% 8%, #fef08a 0, #fef08a 16%, transparent 18%),
      radial-gradient(
        circle at 93% 12%,
        #86efac 0,
        #86efac 12%,
        transparent 14%
      ),
      repeating-linear-gradient(
        -8deg,
        #f8fafc 0,
        #f8fafc 24px,
        #f1f5f9 24px,
        #f1f5f9 48px
      );
  }

  .scratch-shell-3 {
    background:
      repeating-linear-gradient(
        to bottom,
        transparent 0,
        transparent 2px,
        rgba(20, 83, 45, 0.08) 3px,
        rgba(20, 83, 45, 0.08) 4px
      ),
      radial-gradient(
        circle at 50% -10%,
        rgba(86, 255, 154, 0.16),
        transparent 42%
      ),
      radial-gradient(circle at 50% 0%, #0d1813, #050907 68%);
  }

  .scratch-shell-5 {
    background:
      linear-gradient(0deg, rgba(4, 18, 15, 0.93), rgba(4, 18, 15, 0.93)),
      radial-gradient(
        circle at 82% 12%,
        rgba(110, 231, 183, 0.34),
        transparent 30%
      ),
      radial-gradient(
        circle at 12% 88%,
        rgba(34, 197, 94, 0.28),
        transparent 30%
      ),
      #02110d;
  }

  .scratch-nav {
    display: flex;
    flex-wrap: wrap;
    gap: 0.55rem;
    margin: 0 auto 1rem;
    width: min(1140px, 100%);
    font-family: Rubik, sans-serif;
  }

  .scratch-nav a {
    border: 2px solid #111827;
    padding: 0.25rem 0.75rem;
    font-weight: 700;
    background: #ffffff;
    color: #111827;
    box-shadow: 4px 4px 0 #111827;
  }

  .scratch-nav a[aria-current="page"] {
    background: #facc15;
  }

  .scratch-home {
    width: min(1140px, 100%);
    margin: 0 auto;
    border: 3px solid #111827;
    box-shadow: 10px 10px 0 #111827;
    background: #ffffff;
    padding: clamp(1rem, 2vw, 1.5rem);
    color: #111827;
    font-family: Rubik, sans-serif;
  }

  .scratch-home h1 {
    font-size: clamp(1.5rem, 4vw, 2rem);
    margin-bottom: 0.5rem;
  }

  .scratch-home p {
    margin-bottom: 0.7rem;
    line-height: 1.5;
    max-width: 64ch;
  }

  .scratch-home ul {
    display: grid;
    gap: 0.45rem;
  }

  .scratch-home a {
    text-decoration: underline;
  }
</style>
